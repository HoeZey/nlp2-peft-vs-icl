#!/bin/bash

#SBATCH --partition=gpu_h100
#SBATCH --gpus=2
#SBATCH --job-name=EV3S
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=8
#SBATCH --time=1:30:00
#SBATCH --output=outputs/eval/%A_llama2_3s_greedy.out

module purge
module load 2024
module load Anaconda3/2024.06-1

cd $HOME/nlp2/

source activate nlp2
srun python -u src/main_eval.py \
    --model_path "meta-llama/Llama-2-7b-hf" \
    --num_gpus 2 \
    --system_prompt_path "config/prompts/gsm8k_empty.txt" \
    --eval_dataset "openai/gsm8k" \
    --eval_dataset_config_name "main" \
    --icl_dataset "openai/gsm8k" \
    --icl_dataset_config_name "main" \
    --k 3 \
    --batch_size 1319 \
    --max_tokens 16000 \
    --temperature 0.0 \
    --output_dir "./model_outputs/gsm8k"
conda deactivate